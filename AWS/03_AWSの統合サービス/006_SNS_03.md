## 目次

-   前回までの復習
-   Amazon Simple Notification Service （SNS）3/3

## 前回までの復習

---

### 問題 1

SNS を使ってモバイル端末へ PUSH 通知を行う際に、端末を識別するための固有の情報を何といいますか。  
また、それを`プラットフォームアプリケーション`に登録したときに発行される物は何か。

---

### 問題 2

`ARN`とは何の略称で、何を表しているか。

---

### 問題 3

ある Web サービスでは iOS アプリへの PUSH 通知を行っている。  
ある時を境にアプリやバックエンド処理の修正を行っていないにも関わらず、
すべてのユーザに対して PUSH 通知が届かなくなった。  
そのほかのアプリの機能に不具合は出ていない。
原因として考えられる内容は何か。

---

### 問題 4

SNS からモバイル端末に PUSH 通知を送る際に、SNS とモバイル端末の間にプラットフォームが介在する。  
iOS 端末向けのプラットフォームの名前、Android 端末向けのプラットフォームの名前は何か。

---

### 問題 5

とある SNS トピックにおいて、指定された属性が付与されたメッセージのみを受け取りたいという要件がある。  
`Subscriber`側に対して、とある設定を施すことで実現できる。
この設定の名前は何か。

---

## Amazon Simple Notification Service （SNS） 3 回(全 3 回)

### ハンズオン

#### 成果物

-   Email と Lambda に対してメッセージを送信する仕組み
-   EC2 や Lambda からメッセージを送る仕組み

#### Email と Lambda に対してメッセージを送信する

#### 手順

1.  トピックを作成する

-   サービスの一覧より`Simple Notification Service`を選択
-   左に表示されるメニューから`トピック`を選択
-   オレンジのボタン`トピックの作成`を押下
-   画面内の以下を選択・入力(記載のない項目は変更不要)
    -   タイプ : `スタンダード`
    -   名前 : `workshop0613`
-   オレンジのボタン`トピックの作成`を押下

2. サブスクリプションを作成する(プロトコル：Email)

-   トピックの一覧より、`workshop0613`を選択
-   画面下部の`サブスクリプション`タブの中の`サブスクリプションの作成`を押下
-   画面内の以下を選択・入力(記載のない項目は変更不要)
    -   プロトコル : `Email`
    -   エンドポイント : 実施時に連携
-   オレンジのボタン`サブスクリプションの作成`を押下
-   作成したサブスクリプションのステータスが`保留中の確認`になることを確認する
-   送信先のメールアドレスの受信者側で`サブスクリプション`の購読を承認する
-   作成したサブスクリプションのステータスが`確認済み`になることを確認する

3. メッセージを発行する

-   トピックの一覧より、`workshop0613`を選択
-   `メッセージの発行`を押下
-   画面内の以下を選択・入力(記載のない項目は変更不要)
    -   件名 : 任意の半角英数字
    -   本文 : 任意の文字列
-   オレンジのボタン`メッセージの発行`を押下
-   送信したメッセージがサブスクリプションに登録したメールアドレスあてに届くことを確認

4. サブスクリプションを作成する(プロトコル：Lambda)

-   トピックの一覧より、`workshop0613`を選択
-   画面下部の`サブスクリプション`タブの中の`サブスクリプションの作成`を押下
-   画面内の以下を選択・入力(記載のない項目は変更不要)
    -   プロトコル : `AWS Lambda`
    -   エンドポイント : 末尾が`FromSNS1`の ARN
-   オレンジのボタン`サブスクリプションの作成`を押下
-   作成したサブスクリプションのステータスが`確認済み`になることを確認する
-   画面下部の`サブスクリプション`タブの中の`サブスクリプションの作成`を押下
-   画面内の以下を選択・入力(記載のない項目は変更不要)
    -   プロトコル : `AWS Lambda`
    -   エンドポイント : 末尾が`FromSNS2`の ARN
-   オレンジのボタン`サブスクリプションの作成`を押下
-   作成したサブスクリプションのステータスが`確認済み`になることを確認する

5. メッセージを発行する

-   3. メッセージを発行する の手順と同様にメッセージを発行する
-   Lambda のログにメッセージの本文が表示されていることを確認

6. EC2 からメッセージを送信する

-   以下実施済み手順
    -   Name が`ForPublishMessageByCLI`の EC2 を起動する
    -   EC2 で AWS CLI が使えるようにするために認証情報をセットする
        -   参考：[設定ファイルと認証情報ファイルの設定 - AWS コマンドラインインターフェイス](https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/cli-configure-files.html)
-   Name が`ForPublishMessageByCLI`の EC2 に AWS コンソールから接続する
-   ターミナル上で以下コマンドを実行する
    -   {}で囲っているところは実際の値に置換すること

```
 aws sns publish --topic-arn {送り先のトピックのARN} --message "{本文}"
```

## 次回以降の内容

-   次回：AWS Elastic Beanstalk
-   それ以降：
    -   Amazon CloudFront
    -   AWS CloudFormation
